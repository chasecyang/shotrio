# 场景提取功能使用指南

## 快速开始

### 第一步：进入场景管理

在项目侧边栏中，点击"场景管理"进入场景管理页面。

### 第二步：启动场景提取

在场景管理页面顶部，你会看到一个蓝色的横幅提示：

![场景提取横幅示例]

点击"开始提取"按钮，系统会：
1. 读取你项目中所有剧集的剧本内容
2. 创建一个后台任务，使用 AI 分析并提取场景
3. 显示任务进度

### 第三步：等待 AI 分析

任务提交后，横幅会显示实时进度：

- **正在读取剧本内容...** (10%)
- **AI 正在分析并提取场景...** (30-80%)
- **正在处理提取结果...** (80-100%)

整个过程通常需要 30-60 秒，取决于剧本长度。

### 第四步：预览并编辑场景

任务完成后，横幅会变成绿色，显示"场景提取完成！"。

点击"查看并导入"按钮，打开场景预览对话框：

#### 左侧：场景列表
- 显示所有提取的场景
- 新场景标记为绿色"新"徽章
- 已存在的场景标记为灰色"已存在"徽章
- 点击场景可以在右侧查看详情

#### 右侧：场景详情
- **场景名称**：如"咖啡厅"、"主角的家-客厅"
- **场景描述**：详细的环境描述，包括：
  - 空间布局特征
  - 环境氛围
  - 关键道具和装饰
  - 光线和色调

你可以修改场景名称和描述，但已存在的场景不可编辑。

### 第五步：选择要导入的场景

1. 默认情况下，只有新场景会被选中
2. 你可以取消选择某些不需要的场景
3. 也可以点击"全选"按钮选择所有场景

### 第六步：确认导入

点击底部的"确认导入"按钮：

1. 系统会创建选中的新场景
2. 跳过已存在的同名场景
3. 显示导入结果统计
4. 3 秒后自动关闭对话框并刷新页面

## 使用技巧

### 1. 优化场景描述

好的场景描述应该包含：

✅ **好的示例：**
```
咖啡厅-靠窗位置

温馨的现代咖啡厅，木质桌椅和暖黄色灯光营造出舒适氛围。
靠窗的双人座位，窗外可见繁华街景。桌上摆放着精致的咖啡杯和
甜品，墙面装饰有艺术画作。柔和的自然光从大窗户洒入，
与室内温暖的灯光交织。整体色调以米色和棕色为主。
```

❌ **不好的示例：**
```
咖啡厅

一个咖啡厅。
```

### 2. 场景命名规范

建议使用"地点-具体位置"的命名方式：

- ✅ 主角的家-客厅
- ✅ 公司-总经理办公室
- ✅ 城市街道-夜景
- ❌ 第一场
- ❌ 场景1

### 3. 处理重复场景

如果提取结果中有重复的场景：

1. 在预览对话框中取消选择重复的场景
2. 或者在导入后，在场景管理页面手动删除

### 4. 补充遗漏的场景

如果 AI 遗漏了某些场景：

1. 可以手动点击"创建场景"按钮添加
2. 或者优化剧本中的场景描述后，重新提取

## 常见问题

### Q1: 场景提取失败怎么办？

**可能原因：**
- 项目中没有剧本内容
- 剧本内容过短或没有明确的场景描述
- AI 服务暂时不可用

**解决方法：**
1. 确保项目中至少有一集包含剧本内容
2. 检查剧本中是否有明确的场景描述（如：INT. 咖啡厅 - 白天）
3. 点击"重新提取"按钮重试

### Q2: 为什么有些场景没有被提取？

AI 只会提取在剧本中明确出现的场景。如果某个场景在剧本中没有被提及，需要手动创建。

### Q3: 提取的场景描述不够详细怎么办？

在预览对话框中，你可以直接编辑场景描述。建议补充：
- 环境氛围
- 关键道具
- 光线特征
- 色调风格

### Q4: 可以重新提取场景吗？

可以。已存在的场景会被自动标记并跳过，不会重复创建。

### Q5: 场景提取后需要做什么？

提取场景后，下一步是为每个场景生成视角参考图：

1. 在场景卡片中点击"生成视角"
2. 选择生成"全景布局图"或"叙事主力视角"
3. AI 会基于场景描述生成参考图

## 最佳实践

### 1. 剧本准备

在提取场景前，确保剧本中包含清晰的场景描述：

```
INT. 咖啡厅 - 白天

温馨的咖啡厅，靠窗的位置。李明坐在窗边，看着窗外的街景。

李明
    （若有所思）
    这个城市真美...
```

### 2. 分批处理

如果项目很大（超过 10 集），可以：
1. 先提取一次，获得主要场景
2. 编辑并完善这些场景
3. 后续有新增场景时，再次提取（会自动跳过已有场景）

### 3. 场景复用

对于经常出现的场景（如主角的家），建议：
1. 在场景描述中写得详细一些
2. 生成高质量的视角参考图
3. 在所有相关镜头中复用这个场景

## 下一步

场景创建完成后，你可以：

1. **生成场景视角图**：为每个场景生成"全景布局图"和"叙事主力视角"
2. **在分镜中使用**：创建分镜时关联场景，确保视觉风格统一
3. **优化场景描述**：根据生成的图片效果，持续优化场景描述

---

需要帮助？请参考 [场景功能完整文档](./scene-extraction-feature.md)

